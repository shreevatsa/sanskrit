Some lessons from looking at the history of the code

* Keep it as modular as possible

* Avoid side effects, e.g. functions that print

